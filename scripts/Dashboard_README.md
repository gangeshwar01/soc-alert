# üîê **CICIDS2018 Threat Detection Dashboard**

### Streamlit-Based Real-Time Attack Classification, Anomaly Detection & Risk Scoring

This dashboard provides an interactive interface for loading large CICIDS2018 datasets in **chunked mode**, preprocessing them efficiently, running predictions using the trained model bundle, computing **risk levels**, generating **enhanced CSV outputs**, and exporting a **multi-page PDF report** with detailed analytics.

It integrates prediction, anomaly scoring, risk evaluation, visualization, and report generation ‚Äî all in a unified Streamlit interface.

---

## üöÄ **Features**

### ‚úî Model-Based Predictions (CICIDS2018)

Automatically loads your trained model components:

| File                           | Purpose                                        |
| ------------------------------ | ---------------------------------------------- |
| `cicids2018_rf_model_A.joblib` | RandomForest classifier                        |
| `cicids2018_scaler_A.joblib`   | StandardScaler used during training            |
| `cicids2018_features_A.joblib` | Full list of numeric features used in training |

Supports:

* `predict()` ‚Äì class prediction
* `predict_proba()` ‚Äì probability scores
* **IsolationForest anomaly detection**
* **Risk Level Classification (LOW / MEDIUM / HIGH)**

Risk level is computed using:

* Prediction label (attack vs benign)
* IsolationForest anomaly score

---

## üéõ **Dashboard Features & Analytics Panels**

### **1. Dataset Overview**

* Load CSV or local file path
* Streaming chunk processing (RAM-efficient)
* Displays first rows, feature count, missing value summary
* Automatic label/timestamp detection
* Class distribution (if labels exist)

---

### **2. Classification & Confusion Matrix**

* Predictions for each row
* Probability scores (if available)
* Confusion matrix heatmap
* Classification report table
* Precision / recall / F1 visualization

---

### **3. Anomaly Detection**

* IsolationForest anomaly score per row
* Anomaly score histogram
* Outlier detection stats

---

### **4. Timeline & Trends (If timestamp exists)**

* Group attacks per minute
* Auto-generates synthetic timestamps if missing
* Line chart of attack frequency over time

---

### **5. Risk-Level Analysis (NEW)**

* Automatic **LOW / MEDIUM / HIGH** classification
* Risk level summary
* Risk distribution bar chart
* Included in CSV output
* Included in PDF report

---

### **6. Export**

* **Enhanced Predictions CSV**
  Includes:

  ```
  prediction, iso_score, risk_level, true_label, timestamp
  ```

* **Multi-Page PDF Report (NEW)**
  Contains:

  * Overall summary
  * Risk summary + bar chart
  * Confusion matrix
  * Classification report
  * ROC curves
  * Precision/recall bars
  * Anomaly score histogram
  * Timeline chart (if timestamp exists)

---

## üì• **Supported Input Formats**

The dashboard accepts:

* `.csv` (recommended)
* File upload or local path
* Large datasets processed in **streaming chunks**
* Auto-handles missing or mixed numeric formats

If timestamp is missing ‚Üí synthetic timestamps can be auto-created.

---

## üìÇ **Required Model Files**

Defaults:

```python
MODEL_PATH  = r"D:\RealTime_Alert_Analysis\model\cicids2018_rf_model_A.joblib"
SCALER_PATH = r"D:\RealTime_Alert_Analysis\model\cicids2018_scaler_A.joblib"
FEATURES_PATH = r"D:\RealTime_Alert_Analysis\model\cicids2018_features_A.joblib"
```

These correspond to output generated by:

```
scripts/train.py
```

The model bundle includes:

* RandomForest classifier
* IsolationForest anomaly model
* StandardScaler
* Feature alignment list
* Class label list

---

## üß† **How It Works (Internal Pipeline Summary)**

### **1. Load Model & Scaler**

Cached with:

```python
@st.cache_resource
```

### **2. Load Dataset**

* Reading in chunks (default 40,000 rows)
* Streaming prevents memory overflow

### **3. Normalize Column Names**

Lowercase, strip symbols, unify naming.

### **4. Detect Columns**

* Identify label column automatically
* Identify timestamp column if present

### **5. Feature Extraction**

* Aligns input columns to training features
* Fills missing ones with zeros
* Drops unseen/unnecessary columns

### **6. Preprocessing & Prediction**

* Apply StandardScaler
* RandomForest ‚Üí predictions
* IsolationForest ‚Üí anomaly scores
* Risk function computes **LOW/MEDIUM/HIGH**

### **7. Build Final DataFrame**

Includes:

```
prediction
iso_score
risk_level
true_label (optional)
timestamp (optional)
```

### **8. Visualizations**

Confusion matrix, ROC, PR charts, histograms, risk overview, timeline.

---

## ‚ñ∂ **Running the Dashboard**

### 1. Install dependencies

```bash
pip install -r requirements.txt
```

### 2. Run Streamlit

```bash
streamlit run scripts/dashboard.py
```

Dashboard opens at:

```
http://localhost:8501
```

---

## üìä **Output Files**

| File                                       | Description                              |
| ------------------------------------------ | ---------------------------------------- |
| `cicids_chunked_predictions_with_risk.csv` | Predictions + risk level + anomaly score |
| `classification_report.png`                | Training PNG report from training script |
| `plots/*.png` (optional)                   | Exported visualizations                  |
| `cicids_risk_report.pdf` (NEW)             | Multi-page PDF including risk summary    |

---

## üìå Notes

* Dashboard standardizes incoming data automatically.
* If true labels are missing ‚Üí confusion matrix & ROC are disabled.
* Timestamp missing ‚Üí synthetic timestamps generated for timeline only.
* Works exclusively with **CICIDS2018 models trained via `train.py`**.
* Designed for **large datasets** (streaming in chunks for RAM efficiency).

